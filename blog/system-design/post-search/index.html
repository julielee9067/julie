<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/julie/_next/static/media/a15f2fce4b98b461-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https://julielee9067.github.io/julie?&amp;count_bg=%23B397D3&amp;title_bg=%23DDBCD8&amp;icon=awesomelists.svg&amp;icon_color=%23E7E7E7&amp;title=-++&amp;edge_flat=false"/><link rel="stylesheet" href="/julie/_next/static/css/064e10fa6619f508.css" data-precedence="next"/><link rel="stylesheet" href="/julie/_next/static/css/e680cef9016abb97.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/julie/_next/static/chunks/webpack-f21d1ea040903a64.js"/><script src="/julie/_next/static/chunks/fd9d1056-31cd4e5e32ed9a2a.js" async=""></script><script src="/julie/_next/static/chunks/117-716e42ebd9d4aa99.js" async=""></script><script src="/julie/_next/static/chunks/main-app-6f6fdd4063037f11.js" async=""></script><script src="/julie/_next/static/chunks/137-7c01c277e0f0cc48.js" async=""></script><script src="/julie/_next/static/chunks/269-a28aad18182cd41e.js" async=""></script><script src="/julie/_next/static/chunks/614-0bac26ad143a75db.js" async=""></script><script src="/julie/_next/static/chunks/app/blog/%5B...slug%5D/page-c538284416fbde4d.js" async=""></script><script src="/julie/_next/static/chunks/648-3ae006cfe07c9d94.js" async=""></script><script src="/julie/_next/static/chunks/app/blog/layout-a0ac16c7cad7b2d1.js" async=""></script><script src="/julie/_next/static/chunks/app/layout-2f9a78561536bd6f.js" async=""></script><title>Julie Lee&#x27;s Portfolio</title><meta name="description" content="Welcome to Julie&#x27;s portfolio page."/><meta name="next-size-adjust"/><script src="/julie/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__className_29e2ff"><script>((e,t,r,n,o,a,l,i)=>{let u=document.documentElement,s=["light","dark"];function c(t){(Array.isArray(e)?e:[e]).forEach(e=>{let r="class"===e,n=r&&a?o.map(e=>a[e]||e):o;r?(u.classList.remove(...n),u.classList.add(t)):u.setAttribute(e,t)}),i&&s.includes(t)&&(u.style.colorScheme=t)}if(n)c(n);else try{let e=localStorage.getItem(t)||r,n=l&&"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e;c(n)}catch(e){}})("class","theme","system",null,["light","dark"],null,true,true)</script><header class="fixed top-0 left-0 w-full z-50 bg-background/80 backdrop-blur-sm border-b"><div class="max-w-6xl mx-auto px-4 h-16 flex items-center justify-between"><a class="font-bold text-lg" href="/julie/">JULIE</a><div class="flex items-center gap-4"><a><img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https://julielee9067.github.io/julie?&amp;count_bg=%23B397D3&amp;title_bg=%23DDBCD8&amp;icon=awesomelists.svg&amp;icon_color=%23E7E7E7&amp;title=-++&amp;edge_flat=false"/></a><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-download w-4 h-4 mr-2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" x2="12" y1="15" y2="3"></line></svg>이력서</button><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 w-16">KO</button><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 w-10"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-[1.2rem] w-[1.2rem] transition-all dark:hidden"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon h-[1.2rem] w-[1.2rem] hidden transition-all dark:block"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg><span class="sr-only">Toggle theme</span></button></div></div></header><div class="min-h-screen flex flex-col bg-white dark:bg-black"><div class="pt-16 flex flex-1"><aside class="
        fixed top-16 left-0 h-[calc(100vh-4rem)] w-64
        bg-white dark:bg-neutral-900 text-black dark:text-white
        border-r border-gray-200 dark:border-gray-700 shadow-sm p-6 overflow-y-auto z-50
        transition-transform duration-300
        translate-x-0
        lg:translate-x-0
      "><h2 class="text-lg font-semibold mb-4">카테고리</h2><ul class="space-y-2"><li><a class="block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition" href="/julie/blog/">전체</a></li><li><a class="block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition" href="/julie/blog/to-do/">TO DO 리스트</a></li><li><a class="block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition" href="/julie/blog/algorithms/">알고리즘</a></li><li><a class="block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition" href="/julie/blog/til/">Today I Learned</a></li><li><a class="block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition" href="/julie/blog/cs/">컴퓨터 공학</a></li><li><a class="block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition" href="/julie/blog/computer-networks/">컴퓨터 네트워크</a></li><li><a class="block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition" href="/julie/blog/system-design/">시스템 디자인</a></li></ul></aside><main class="flex-1 p-6 transition-all duration-300 ml-0 lg:ml-64"><!--$!--><template data-dgst="BAILOUT_TO_CLIENT_SIDE_RENDERING"></template><!--/$--></main></div><button class="
            fixed left-0 top-1/2 -translate-y-1/2 z-50 p-2 rounded-r-md shadow transition
            bg-white text-black hover:bg-gray-100
            dark:dark:bg-neutral-900 dark:text-white dark:hover:bg-neutral-800
          ">&lt;</button><div class="fixed inset-0 bg-black/30 z-40 lg:hidden"></div></div><script src="/julie/_next/static/chunks/webpack-f21d1ea040903a64.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/julie/_next/static/media/a15f2fce4b98b461-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/julie/_next/static/css/064e10fa6619f508.css\",\"style\"]\n3:HL[\"/julie/_next/static/css/e680cef9016abb97.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"4:I[2846,[],\"\"]\n6:\"$Sreact.suspense\"\n7:I[1523,[\"137\",\"static/chunks/137-7c01c277e0f0cc48.js\",\"269\",\"static/chunks/269-a28aad18182cd41e.js\",\"614\",\"static/chunks/614-0bac26ad143a75db.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-c538284416fbde4d.js\"],\"BailoutToCSR\"]\n8:I[3124,[\"137\",\"static/chunks/137-7c01c277e0f0cc48.js\",\"269\",\"static/chunks/269-a28aad18182cd41e.js\",\"614\",\"static/chunks/614-0bac26ad143a75db.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-c538284416fbde4d.js\"],\"default\"]\na:I[4707,[],\"\"]\nc:I[6423,[],\"\"]\nd:I[3483,[\"648\",\"static/chunks/648-3ae006cfe07c9d94.js\",\"768\",\"static/chunks/app/blog/layout-a0ac16c7cad7b2d1.js\"],\"default\",1]\ne:I[5495,[\"137\",\"static/chunks/137-7c01c277e0f0cc48.js\",\"648\",\"static/chunks/648-3ae006cfe07c9d94.js\",\"185\",\"static/chunks/app/layout-2f9a78561536bd6f.js\"],\"ThemeProvider\"]\nf:I[4491,[\"137\",\"static/chunks/137-7c01c277e0f0cc48.js\",\"648\",\"static/chunks/648-3ae006cfe07c9d94.js\",\"185\",\"static/chunks/app/layout-2f9a78561536bd6f.js\"],\"LanguageProvider\"]\n10:I[1890,[\"137\",\"static/chunks/137-7c01c277e0f0cc48.js\",\"648\",\"static/chunks/648-3ae006cfe07c9d94.js\",\"185\",\"static/chunks/app/layout-2f9a78561536bd6f.js\"],\"Header\"]\n12:I[1060,[],\"\"]\n9:T3086,"])</script><script>self.__next_f.push([1,"\n## 개요\n커뮤니티 앱에서 게시글 검색 기능을 어떻게 구현할 수 있을까요?\n\n특히 Full-text search나 elasticsearch 같은 검색 엔진 없이, 직접 검색 기능을 만들어보는 방법들을 살펴보겠습니다.\n\n## 기능적 요구사항\n1. 게시글 생성 기능\n2. 게시글 좋아요 기능\n3. 키워드로 게시글 검색 기능\n4. 검색 결과 최신순/좋아요 수 순으로 정렬 기능\n\n## 비기능적 요구사항\n1. Query latency \u003c 500ms\n2. 많은 요청 지원\n3. 모든 게시글이 검색 대상이 되어야 함\n4. 신규 게시글은 게시 후 최대 1분 내에 검색 가능해야 함\n5. High availability\n\n\u003e Hot data / Cold data를 나눠서 생각하는 게 좋습니다. 자주 조회되는 데이터(hot data)는 메모리에 둬서 빠르게 응답하고, cold data는 디스크나 원격 db로 보관할 수 있습니다.\n\n## 규모 추정\n우리는 대규모 시스템을 전제로 하기 때문에, 데이터 총량, write TPS, read TPS와 같은 정보를 추정해봐야 합니다.\n\n검색 시스템이라고 해서 검색 쿼리만 중요한 것이 아니라 게시글 생성, 좋아요 등 쓰기 요청이 훨씬 많을 수도 있음을 인지해야 합니다.\n\n1. 커뮤니티 사용자가 **10억 명**(1 Billion) 있다고 가정\n2. 평균적으로 사용자 1명이 하루 **1개 게시글** 작성\n3. 사용자 1명이 하루에 **10번** 다른 사람의 게시글에 좋아요\n\n**쓰기 연산 추정**\n```\n게시글 생성: 10억 명 * (1 post/일) / 86400초/일 ≈ 초당 10,000개의 게시글\n좋아요: 10억 명 * (10 likes/일) / 86400초/일 ≈ 초당 100,000개의 좋아요\n```\n\n**읽기 연산 추정**\n```\n검색 요청: 10억 명 * (1 search/일) / 86400초/일 ≈ 초당 10,000번의 검색\n```\n\n위 두개 연산을 비교해 봤을 때, 살제로 **검색 요청보다 쓰기 비중(게시글 + 좋아요)이 높다**는 것을 확인할 수 있습니다.\n\n**스토리지 용량 추정**\n1. 데이터를 10년간 보관한다고 가정\n2. 게시글 메타데이터는 약 1KB라고 가정\n3. `총 게시글 수: 1 Billion posts/day * 365 day/year * 10 year = 3.6T 개의 게시글`\n4. `총 데이터 크기: 3.6T 개의 게시글 * 1 KB/게시글 = 3.6 PB`\n\n## Core Entities\n1. User\n2. Post\n3. Like\n\n## API 디자인\nAPI는 크게 **쓰기**와 **읽기**로 나누어서 생각할 수 있습니다.\n\n### 쓰기\n1. `createPost(userId, content)`\n2. `likePost(userId, postId)`\n\n### 읽기\n1. `searchPosts(keyword, sortBy)`\n\n## High-Level Design\n### 1. 게시글 생성 / 좋아요 기능\n```\n[ Post Service ] -----+\n                      |-----\u003e [ Load Balancer ] -----\u003e [ Ingestion Service ] -----\u003e [ DB ]\n[ Like Service ] -----+\n```\n보통 대규모 서비스라면 **Post Service**와 **Like Service**가 내부적으로 분리되어 있을 수 있습니다. \n이번에는 검색 기능에 초점을 맞추기 때문에 각각의 서비스 구현 세부 사항은 자세히 다루지 않겠습니다.\n\n단순화된 버전으로는, 이 두 서비스에서 발생하는 모든 Write(게시글 생성/좋아요)가 하나의 **Ingestion Service**를 통해 DB나 인덱스에 들어간다고 볼 수 있습니다.\n\n### 2. 키워드 검색 기능\n게시글을 키워드로 검색하기 위해서는 Read path를 구성해야 하는데, 다음과 같은 요소로 구성될 수 있습니다.\n\n1. **API gateway**: auth, rate limit 등의 처리를 담당\n2. **Search service**: 실제 검색 요청 처리\n3. **Index**\n\n이 문제는 **inverted index**의 전형적인 활용 사례입니다. \n엘라스틱서치 게시글이나 DB Index 게시글에서도 자세히 다뤘지만, inverted index의 가장 중요한 아이디어는 **특정 키워드를 포함하는 문서 목록을 미리 만들어두고, 검색시 해당 키워드에 매핑된 문서 목록을 바로 가져오는 방식**입니다.\n\n간단하고 빠른 검색을 위해 여기서는 **Redis**를 사용할 수 있습니다.\n\n```\n[ Ingestion Service ] -----+\n                            |-----\u003e  [ Index(Redis) ]\n[   Search Service  ] -----+\n```\n\nRedis에 inverted index를 저장해두면 메모리에 있는 데이터를 직접 조회하기 때문에 매우 빠른 검색이 가능합니다.\n물론 휘발성 환경이므로 durability 문제가 있지만, 이는 나중에 memoryDB 같은 대안을 적용해 해결할 수 있습니다.\n\n각 키워드는 **\"해당 키워드를 포함하는 게시글 ID list\"** 를 갖게 되고, 사용자가 새 게시글을 생성하면 ingestion service에서 게시글 내용에 들어있는 모든 키워드를 추출하여 해당 키워드의 리스트에 새 게시글 ID를 append 합니다.\n\n**고려해야 할 사항**\n1. 특정 키워드(예: 아주 흔한 단어)에 매핑된 게시글 목록이 지나치게 커질 수 있음\n2. 한 게시글이 최대 수백~수천 키워드를 가질 수 있으므로, 생성할 때 여러 Redis 키에 쓰기 작업을 해야 함\n\n### 3. 검색 결과 정렬\n검색 결과를 요구 사항에 맞게 (최신 순, 좋아요 수 순) 정렬하려면, 검색 결과가 단순히 해당 키워드가 들어있는 게시글들 뿐만 아니라, 정렬에 필요한 메타데이터를 가져와야 합니다.\n\n여기서는 두 개의 별도 인덱스를 사용할 수 있습니다.\n1. **Creation index**: 게시글 작성 시각 기준 정렬\n2. **Likes index**: 좋아요 개수 기준 정렬\n\n#### Creation Index\nRedis의 **List**를 활용할 수 있습니다.\n\n새로운 게시글이 생성될 때, **해당 키워드에 대한 creation index list** 맨 끝에 post ID를 추가합니다.\n\n최근 게시글 보여줄 때는 리스트의 뒤쪽 요소부터 순회하면 됩니다.\n\n#### Likes Index\nRedis의 **sorted set**을 활용할 수 있습니다.\n\n각 키워드별로 **좋아요 수**를 점수로 설정해서, post ID를 sorted set에 저장합니다.\n새로운 게시글이 생성되면 초기 점수 0으로 삽입하고, 좋아요가 생길 때마다 점수가 업데이트 되며 정렬 순서가 반영됩니다.\n\n위 방법에는 **문제점**이 존재합니다.\n1. 저장 공간(스토리지)이 2배로 늘어남 (Creation \u0026 Likes 두 인덱스)\n2. 좋아요가 아주 자주 발생하면, 그때마다 점수를 업데이트해야 하므로 쓰기 부담이 큼\n\n이를 해결하기 위해 배치 처리, 샤딩, 캐싱 등의 기법을 병행하거나, 좋아요 정보를 주기적으로만 반영하는 방안을 고려할 수 있습니다.\n\n## 상세 설계\n### 1. 사용자 요청이 매우 많을 때는 어떻게 처리할 것인가?\n요구 사항에서 같은 검색어에 대해서는 누구든 같은 결과를 본다고 했고, 1분의 지연이 허용되므로 이 문제에선 캐싱을 적용하기 적합합니다.\n\n#### 분산 캐시\n방법 중 하나는 search service 옆에 distributed cache를 두는 것입니다. \n이 캐시는 특정 키워드에 대한 가장 최신 검색 결과를 저장합니다.\n\n1. 검색 요청이 들어오면, 검색 서비스는 우선 캐시에 결과가 있는지 확인합니다.\n2. 캐시에 해당 결과가 있으면 캐시에서 바로 결과를 반환합니다.\n3. 캐시에 없다면 full search를 수행한 뒤, 검색 결과를 캐시에 저장합니다.\n\n오래된 결과가 계속 남아있는 걸 방지하기 위해 eviction policy도 설정해줘야 합니다.\n\n새 게시글 반영에 1분 정도 지연이 허용되므로, 캐시 항목의 TTL을 1분 미만으로 설정하면 새 게시글이 검색에서 빠지는 상황을 막을 수 있습니다.\n\n### CDN\nRedis 같은 캐시에 더해서, CDN을 활용해서 edge level에서 캐싱할 수도 있습니다.\n\n1. origin 혹은 캐시 대상 서버를 설정하고, DNS를 CDN을 거치도록 구성합니다.\n2. 사용자가 검색 결과를 요청했을 때, CDN 캐시에 해당 항목이 있으면 가장 가까운 CDN 지점에서 응답을 반환합니다.\n3. 캐시에 없다면 CDN이 실게 서버로 요청을 proxy해서 결과를 가져옵니다.\n\nCDN 노드를 통해 응답하면 사용자가 좀 더 짧은 latency로 결과를 받을 수 있다는 장점이 있습니다.\n다만 캐시 무효화나 TTL 정책에 따라 최신 게시글이 늦게 반영될 수 있으므로 요구사항에 맞춰 설정을 잘 해야 합니다.\n\n/search endpoint에 대해서 응답을 보낼 때, cache-control header를 통해서 언제까지 캐시를 유지할지 설정할 수 있습니다.\n\n### 2. 여러 키워드 검색은 어떻게 다룰까?\n사용자가 하나의 키워드가 아니라 긴 문장을 검색할 경우 어떻게 처리해야 할까요?\n\n일반적으로 inverted index에서는 각 키워드 별로 게시글 목록을 가지고 있으니 **각 목록의 교집합**을 구해 결과를 만들 수 있습니다.\n\nphrase 검색이라면 인접 단어 관계를 추적하는 인덱스 구조나, 슬라이딩 윈도우를 이용한 기법을 사용할 수도 있습니다.\n\n예를 들어, **Bigram 단위로도 인덱스**를 만들 수 있습니다.\n이렇게 하면 다중 키워드 검색 시 교집합 연산을 줄이고 더 빠른 검색이 가능합니다.\n\n하지만 **인덱스 크기가 폭증**하고 **빈도가 낮은 bigram이 너무 많아진다**는 단점이 있습니다.\n\n이런 단점을 완화하기 위해, 모든 Bigram을 저장하지 않고, **자주 등장하거나 검색될 확률이 높은 bigram만 인덱싱** 할 수 있습니다.\n(빈도를 추적해보고 특정 기준 이상일 때만 인덱스 생성)\n\n\n### 3. 매우 높은 쓰기 부하를 어떻게 처리할 것인가\n앞서 규모 추정에서 알아봤듯, 게시글 생성은 초당 1만 건, 좋아요는 초당 10만 건 발생할 수 있습니다.\n\n#### 게시글 생성\nIngestion service가 게시글을 받아 토큰화해서 키워드별 inverted index에 연결해야 합니다.\n\n예를 들어 게시글에 100개의 단어가 있다면, inverted index에 100번 쓰기를 거쳐야합니다.\n동시에 엄청나게 많은 게시글이 생성된다면 **Ingestion service가 병목**이 될 수 있습니다.\n\n이를 해결하기 위해 다음과 같은 방법을 고려할 수 있습니다.\n1. **Kafka** 같은 stream 시스템을 도입해 생성 요청을 여러 인스턴스에 분산 처리\n2. **버퍼링**을 통해 일시적으로 쌓아뒀다가, 일괄 배치로 inverted index에 반영 (1분 latency 허용이 있으므로 가능)\n3. 인덱스를 샤딩하여, 키워드 범위별로 여러 서버가 나눠서 처리\n\n#### 좋아요\n좋아요 수가 실시간 반영되어야 하는지, 어느 정도 지연이 허용되는지에 따라 전략이 달라집니다.\n\n실시간 반영이 부담스러우면, 좋아요 정보를 별도 저장하고 주기적으로 인덱스를 업데이트하거나, 검색 시점에 최종 like count를 DB에서 조회해 재정렬할 수 있습니다.\n\n예를 들어, 게시글의 좋아요 수가 2의 제곱 단위(혹은 10의 제곱 단위)를 넘어설 때만 인덱스를 갱신할 수 있습니다.\n이렇게 하면 1000개의 좋아요가 생겨도 실제 인덱스 업데이트는 10번 정도로 줄어듭니다.\n\n결국 인덱스에 있는 좋아요 수는 근사치가 되므로 검색할 때 상위 N개 정도만 인덱스에서 가져온 뒤, 실제 like service에 최종 like count를 조회해서 정확한 순서로 재정렬 하는 방식을 쓸 수 있습니다.\n\n**Flow**\n1. 게시글 생성 시 likes index에 0점으로 삽입\n2. 사용자가 1번 좋아요 -\u003e Like count = 1 -\u003e 인덱스 업데이트\n3. 이후 다음 마일스톤 (2, 4, 8, ...)에 도달할 때마다 업데이트\n4. 검색 시 상위 후보군 (ex) top 100)을 가져온 뒤, 각 게시글의 실제 Like 수를 Db에서 조회한 후 최종 정렬\n\n\n\n### 4. 스토리지 최적화\n전체 inverted index를 전부 메모리에 넣으려면 비용이 아주 많이 늘어나므로 다음과 같은 최적화 방안을 고려해 볼 수 있습니다.\n\n1. **키워드별 인덱스의 크기 제한**: 일정 개수를 넘으면 세부 정보를 압축·요약 처리\n2. **잘 검색되지 않는 키워드는 Cold Storage**로 옮긴 뒤, 검색 요청이 오면 천천히(느리지만) 가져온다. 예: AWS S3 등\n\n## 마무리\n오늘은 대규모 검색 시스템 설계에 대해서 다루어 보았습니다.\n\n다음엔 어떤 걸 공부해볼ㄲ ㅏ.. \n\n\n"])</script><script>self.__next_f.push([1,"b:[\"slug\",\"system-design/post-search\",\"c\"]\n13:[]\n"])</script><script>self.__next_f.push([1,"0:[\"$\",\"$L4\",null,{\"buildId\":\"NaZIj2JiavFCpU3la-qKe\",\"assetPrefix\":\"/julie\",\"urlParts\":[\"\",\"blog\",\"system-design\",\"post-search\",\"\"],\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"system-design/post-search\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"system-design\\\",\\\"post-search\\\"]}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"system-design/post-search\",\"c\"],{\"children\":[\"__PAGE__\",{},[[\"$L5\",[\"$\",\"$6\",null,{\"fallback\":null,\"children\":[\"$\",\"$L7\",null,{\"reason\":\"next/dynamic\",\"children\":[\"$\",\"$L8\",null,{\"post\":{\"slug\":\"system-design/post-search\",\"categorySlug\":\"system-design\",\"title\":{\"ko\":\"게시글 검색 서비스 시스템 디자인\",\"en\":\"Design post search service\"},\"date\":\"2025-03-15 16:40\",\"category\":{\"ko\":\"시스템 디자인\",\"en\":\"System Design\"},\"description\":{\"ko\":\"대규모 검색 서비스 설계\",\"en\":\"System design for post searching service\"},\"content\":\"$9\"}}]}]}],null],null],null]},[null,[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$b\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[[null,[\"$\",\"$Ld\",null,{\"children\":[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}],\"params\":{}}]],null],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/julie/_next/static/css/064e10fa6619f508.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/julie/_next/static/css/e680cef9016abb97.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"ko\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"__className_29e2ff\",\"children\":[\"$\",\"$Le\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[\"$\",\"$Lf\",null,{\"children\":[[\"$\",\"$L10\",null,{}],[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[]}]]}]}]}]}]],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$L11\"],\"globalErrorComponent\":\"$12\",\"missingSlots\":\"$W13\"}]\n"])</script><script>self.__next_f.push([1,"11:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Julie Lee's Portfolio\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"Welcome to Julie's portfolio page.\"}],[\"$\",\"meta\",\"4\",{\"name\":\"next-size-adjust\"}]]\n5:null\n"])</script></body></html>