<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/julie/_next/static/media/a15f2fce4b98b461-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https://julielee9067.github.io/julie?&amp;count_bg=%23B397D3&amp;title_bg=%23DDBCD8&amp;icon=awesomelists.svg&amp;icon_color=%23E7E7E7&amp;title=-++&amp;edge_flat=false"/><link rel="stylesheet" href="/julie/_next/static/css/064e10fa6619f508.css" data-precedence="next"/><link rel="stylesheet" href="/julie/_next/static/css/e680cef9016abb97.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/julie/_next/static/chunks/webpack-f21d1ea040903a64.js"/><script src="/julie/_next/static/chunks/fd9d1056-31cd4e5e32ed9a2a.js" async=""></script><script src="/julie/_next/static/chunks/117-716e42ebd9d4aa99.js" async=""></script><script src="/julie/_next/static/chunks/main-app-6f6fdd4063037f11.js" async=""></script><script src="/julie/_next/static/chunks/137-7c01c277e0f0cc48.js" async=""></script><script src="/julie/_next/static/chunks/269-a28aad18182cd41e.js" async=""></script><script src="/julie/_next/static/chunks/614-0bac26ad143a75db.js" async=""></script><script src="/julie/_next/static/chunks/app/blog/%5B...slug%5D/page-c538284416fbde4d.js" async=""></script><script src="/julie/_next/static/chunks/648-3ae006cfe07c9d94.js" async=""></script><script src="/julie/_next/static/chunks/app/blog/layout-a0ac16c7cad7b2d1.js" async=""></script><script src="/julie/_next/static/chunks/app/layout-2f9a78561536bd6f.js" async=""></script><title>Julie Lee&#x27;s Portfolio</title><meta name="description" content="Welcome to Julie&#x27;s portfolio page."/><meta name="next-size-adjust"/><script src="/julie/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__className_29e2ff"><script>((e,t,r,n,o,a,l,i)=>{let u=document.documentElement,s=["light","dark"];function c(t){(Array.isArray(e)?e:[e]).forEach(e=>{let r="class"===e,n=r&&a?o.map(e=>a[e]||e):o;r?(u.classList.remove(...n),u.classList.add(t)):u.setAttribute(e,t)}),i&&s.includes(t)&&(u.style.colorScheme=t)}if(n)c(n);else try{let e=localStorage.getItem(t)||r,n=l&&"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e;c(n)}catch(e){}})("class","theme","system",null,["light","dark"],null,true,true)</script><header class="fixed top-0 left-0 w-full z-50 bg-background/80 backdrop-blur-sm border-b"><div class="max-w-6xl mx-auto px-4 h-16 flex items-center justify-between"><a class="font-bold text-lg" href="/julie/">JULIE</a><div class="flex items-center gap-4"><a><img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https://julielee9067.github.io/julie?&amp;count_bg=%23B397D3&amp;title_bg=%23DDBCD8&amp;icon=awesomelists.svg&amp;icon_color=%23E7E7E7&amp;title=-++&amp;edge_flat=false"/></a><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-download w-4 h-4 mr-2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" x2="12" y1="15" y2="3"></line></svg>이력서</button><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 w-16">KO</button><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 w-10"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun h-[1.2rem] w-[1.2rem] transition-all dark:hidden"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="m17.66 17.66 1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="m6.34 17.66-1.41 1.41"></path><path d="m19.07 4.93-1.41 1.41"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon h-[1.2rem] w-[1.2rem] hidden transition-all dark:block"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg><span class="sr-only">Toggle theme</span></button></div></div></header><div class="min-h-screen flex flex-col bg-white dark:bg-black"><div class="pt-16 flex flex-1"><aside class="
        fixed top-16 left-0 h-[calc(100vh-4rem)] w-64
        bg-white dark:bg-neutral-900 text-black dark:text-white
        border-r border-gray-200 dark:border-gray-700 shadow-sm p-6 overflow-y-auto z-50
        transition-transform duration-300
        translate-x-0
        lg:translate-x-0
      "><h2 class="text-lg font-semibold mb-4">카테고리</h2><ul class="space-y-2"><li><a class="block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition" href="/julie/blog/">전체</a></li><li><a class="block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition" href="/julie/blog/to-do/">TO DO 리스트</a></li><li><a class="block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition" href="/julie/blog/algorithms/">알고리즘</a></li><li><a class="block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition" href="/julie/blog/til/">Today I Learned</a></li><li><a class="block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition" href="/julie/blog/cs/">컴퓨터 공학</a></li><li><a class="block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition" href="/julie/blog/computer-networks/">컴퓨터 네트워크</a></li><li><a class="block px-3 py-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition" href="/julie/blog/system-design/">시스템 디자인</a></li></ul></aside><main class="flex-1 p-6 transition-all duration-300 ml-0 lg:ml-64"><!--$!--><template data-dgst="BAILOUT_TO_CLIENT_SIDE_RENDERING"></template><!--/$--></main></div><button class="
            fixed left-0 top-1/2 -translate-y-1/2 z-50 p-2 rounded-r-md shadow transition
            bg-white text-black hover:bg-gray-100
            dark:dark:bg-neutral-900 dark:text-white dark:hover:bg-neutral-800
          ">&lt;</button><div class="fixed inset-0 bg-black/30 z-40 lg:hidden"></div></div><script src="/julie/_next/static/chunks/webpack-f21d1ea040903a64.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/julie/_next/static/media/a15f2fce4b98b461-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/julie/_next/static/css/064e10fa6619f508.css\",\"style\"]\n3:HL[\"/julie/_next/static/css/e680cef9016abb97.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"4:I[2846,[],\"\"]\n6:\"$Sreact.suspense\"\n7:I[1523,[\"137\",\"static/chunks/137-7c01c277e0f0cc48.js\",\"269\",\"static/chunks/269-a28aad18182cd41e.js\",\"614\",\"static/chunks/614-0bac26ad143a75db.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-c538284416fbde4d.js\"],\"BailoutToCSR\"]\n8:I[3124,[\"137\",\"static/chunks/137-7c01c277e0f0cc48.js\",\"269\",\"static/chunks/269-a28aad18182cd41e.js\",\"614\",\"static/chunks/614-0bac26ad143a75db.js\",\"797\",\"static/chunks/app/blog/%5B...slug%5D/page-c538284416fbde4d.js\"],\"default\"]\na:I[4707,[],\"\"]\nc:I[6423,[],\"\"]\nd:I[3483,[\"648\",\"static/chunks/648-3ae006cfe07c9d94.js\",\"768\",\"static/chunks/app/blog/layout-a0ac16c7cad7b2d1.js\"],\"default\",1]\ne:I[5495,[\"137\",\"static/chunks/137-7c01c277e0f0cc48.js\",\"648\",\"static/chunks/648-3ae006cfe07c9d94.js\",\"185\",\"static/chunks/app/layout-2f9a78561536bd6f.js\"],\"ThemeProvider\"]\nf:I[4491,[\"137\",\"static/chunks/137-7c01c277e0f0cc48.js\",\"648\",\"static/chunks/648-3ae006cfe07c9d94.js\",\"185\",\"static/chunks/app/layout-2f9a78561536bd6f.js\"],\"LanguageProvider\"]\n10:I[1890,[\"137\",\"static/chunks/137-7c01c277e0f0cc48.js\",\"648\",\"static/chunks/648-3ae006cfe07c9d94.js\",\"185\",\"static/chunks/app/layout-2f9a78561536bd6f.js\"],\"Header\"]\n12:I[1060,[],\"\"]\n9:T3cad,"])</script><script>self.__next_f.push([1,"\n## 개요\n시스템을 설계할 때 종종 **많은 데이터 중에서 원하는 정보를 찾아내는** 작업이 필요할 때가 있습니다.\n이 때, 일반적인 데이터베이스로 충분할 때도 있지만 데이터가 많거나 검색 조건이 복잡할 경우엔 전용 검색 엔진이 필요하기도 합니다.\n\nElasticsearch는 그 중 대표적인 **검색 엔진**으로 **정렬, 필터링, 순위 매김, 페이징** 등 다양한 기능을 제공합니다.\n\n또한, 내부 동작 원리를 이해한다면 **분산 시스템 설계, 데이터 구조 최적화, immutable** 등과 같은 개념을 배울 수도 있습니다.\n\n## 기본 개념\nElasticsearch의 핵심 구성 요소는 **문서, 인덱스, 매핑, 필드** 입니다.\n\n1. **문서(Document)**\n\n    **문서**는 **검색 대상이 되는 데이터의 최소 단위**입니다. \n    \n    반드시 웹 페이지나 글일 필요는 없으며 단순한 **JSON 객체**로 표현할 수 있습니다.\n    예를 들어, 영화 데이터베이스를 구축한다고 가정하면 아래와 같이 하나의 문서가 영화 한 편의 정보를 담습니다.\n    ```\n    {\n      \"id\": \"MOV001\",\n      \"title\": \"기생충\",\n      \"director\": \"봉준호\",\n      \"rating\": 8.6,\n      \"releaseDate\": \"2025-01-01T00:00:00.000Z\"\n    }\n    ```\n\n2. **인덱스(Index)**\n\n    인덱스는 **여러 문서들을 논리적으로 모아둔 컨테이너**입니다.\n    \n    **데이터베이스의 테이블**과 유사한 개념으로, 예를 들면 `movies`라는 인덱스에 영화 정보들이 모두 저장됩니다.\n\n3. **매핑(Mapping)**\n\n    **매핑**은 **인덱스에 저장될 데이터의 구조(스키마)를 정의**합니다.\n     \n    즉, 각 문서에 포함된 필드(제목, 감독, 평점, 개봉일 등)의 데이터 타입과 검색 방법을 미리 지정합니다.\n    예를 들어, 아래와 같은 매핑을 설정하면 `id`는 정확한 값 검색이 가능한 `keyword` type, `title`은 텍스트 분석을 거쳐 검색할 수 있는 `text` type 등으로 지정할 수 있습니다.\n\n    단, **매핑에 너무 많은 필드를 포함**시키면 실제 검색에 사용하지 않는 데이터까지 인덱싱되어 **클러스터 메모리 오버헤드가 증가**할 수 있으므로 주의해야 합니다.\n\n    ```\n    {\n      \"properties\": {\n        \"id\": { \"type\": \"keyword\" },\n        \"title\": { \"type\": \"text\" },\n        \"director\": { \"type\": \"text\" },\n        \"rating\": { \"type\": \"float\" },\n        \"releaseDate\": { \"type\": \"date\" }\n      }\n    }\n    ```\n\n## 사용법\nElasticsearch는 **REST API**를 통해 인덱스 생성, 데이터 저장, 검색 등을 수행할 수 있습니다.\n\n자세한 사용법은 엘라스틱서치 공식 문서에서 쉽게 찾아보실 수 있습니다.\n\n## 동작 원리\nElasticsearch는 아주 빠른 검색을 도와주는 프로그램인 **Apache Lucene** 위에서 동작하는 여러 작업들을 조율하는 상위 시스템이라고 볼 수 있습니다.\n\n쉽게 말하면, **Lucene**은 영화 제목이나 감독 같은 **정보를 빠르게 찾을 수 있도록 도와주는 엔진(검색 도구)** 이고, **Elasticsearch**는 이 **Lucene 엔진을 여러 대의 노드에서 동시에 사용할 수 있게 관리해주는 역할**을 합니다.\n\nElasticsearch 클러스터는 여러 종류의 **노드**로 이루어져 있습니다.\n각 노드는 영화 데이터를 저장하거나 검색 요청을 받아 처리하는 등 서로 다른 역할을 맡습니다.\n\n- **마스터 노드**는 전체 클러스터를 관리하며 **새로운 노드를 클러스터에 추가**하거나 **불필요한 노드를 제거하는 등**의 클러스터 수준의 작업을 합니다.\n\n- **데이터 노드**는 **실제로 데이터를 저장하는 역할**을 합니다.\n여기서 저장된 데이터는 실제 영화 저장뿐만 아니라, 검색을 빠르게 하기 위해 미리 만들어 둔 **Lucene 인덱스도 포함**됩니다.\n\n- **코디네이팅 노드**는 사용자로부터 \"영화 '인셉션' 같은 걸 찾아줘\" 라는 요청을 받고, **어느 데이터 노드에 그 작업을 맡길지 결정**한 후 각 노드로부터 받은 결과를 모아 다시 **사용자에게 전달하는 역할**을 합니다.\n\n- **인제스트 노드**는 새로운 데이터가 들어올 때 이를 미리 처리하여 **인덱싱을 준비**합니다.\n\n- **머신러닝 노드**는 영화 추천이나 분석 등 복잡한 작업을 따로 처리합니다.\n\n#### 예시\n예를 들어, 영화 스트리밍 사이트에서 사용자가 새로운 영화를 등록한다고 가정해 보겠습니다.\n\n1. 사용자가 영화 데이터를 **인제스트 노드**에 보내면, 인제스트 노드가 먼저 데이터를 정리한 후 **코디네이팅 노드**에 전달합니다.\n\n2. 코디네이팅 노드는 \"어떤 노드가 이 데이터를 저장하고 검색하기에 좋을까?\"를 판단해서 적절한 **데이터 노드**에 그 일을 맡깁니다.\n\n3. 데이터 노드는 실제로 **영화 데이터를 저장**하면서, 나중에 검색할 때 빠르게 찾을 수 있도록 미리 만들어둔 **Lucene 인덱스에 이 정보를 반영**합니다.\n\n4. **코디네이팅 노드**는 여러 데이터 노드로부터 받은 결과를 모아 사용자에게 보여줍니다.\n\n#### 데이터 노드의 구조\n**데이터 노드**는 영화의 원본 정보(예: 영화의 상세 설명 등)를 **그대로 보관**하는 동시에, 검색 속도를 높이기 위해 **Lucene 인덱스라는 별도의 자료 구조**를 만듭니다.\n이를 쉽게 비유하자면 **영화에 대한 모든 상세 정보를 보관하는 책장**과, 그 **책장에서 원하는 영화를 빠르게 찾을 수 있도록 정리해둔 목차**가 따로 있는 것과 같습니다.\n\n데이터 노드는 검색 요청이 들어오면 두 단계로 처리합니다.\n\n1. **Query 단계**: 미리 만들어둔 인덱스(목차)를 이용해 관련 문서들을 빠르게 찾아냅니다.\n\n2. **Fetch 단계**: 찾은 문서의 ID나 필요한 데이터만 선택적으로 가져옵니다.\n\n이상적인 쿼리는 **원본 데이터를 전혀 읽지 않고 인덱스에 포함된 정보만으로 응답**을 줄 수 있는 경우입니다.\n\n데이터 노드에 저장되는 인덱스는 여러개의 **샤드**와 그 **복제본**으로 구성되어 있습니다.\n\n쉽게 말하면 하나의 영화 데이터베이스를 **여러 개의 작은 책장(샤드)으로 분할해 저장**하는 것과 같습니다.\n그리고 각 **책장마다 영화 정보가 어떻게 정리되어 있는지 목차(Lucene 인덱스)** 가 따로 마련되어 있어, 사용자가 특정 영화 제목을 검색할 때 **모든 책장을 일일이 뒤지지 않고도 해당 영화가 있는 책장을 빠르게** 찾을 수 있습니다.\n\n여기서 주의할 점은 Lucene 인덱스와 elasticsearch 인덱스는 서로 다른 개념이라는 것입니다.\n\n- **Elasticsearch 인덱스**는 영화 데이터와 같이 문서들을 논리적으로 모아둔 컨테이너입니다.\n- **Lucene 인덱스**는 각 샤드가 실제로 데이터를 저장하고 검색을 수행하는 low-level 자료구조로, 한 샤드마다 하나의 Lucene 인덱스가 존재합니다.\n\n검색 작업은 **모든 관련 샤드에서 병렬로 진행**되고 코디네이팅 노드가 각 샤드에서 받은 결과들을 모아 정렬한 후 최종적으로 사용자에게 응답을 제공합니다.\n\n또한, 각 샤드에는 **복제본(Replica)** 이 있어서 한 샤드에 문제가 생기더라도 다른 복제본이 대신 그 역할을 할 수 있습니다.\n만일 한 샤드가 처리할 수 있는 초당 처리량(TPS)이 `X`라면 `Y`개의 복제본을 통해 이론적으로 `X * Y`의 TPS을 처리할 수 있는데, 코디네이팅 노드는 **복제본까지 모두 활용**해 검색 요청을 각 샤드(기본 + 복제본)로 분산시켜 노드 당 작업 부하를 줄입니다.\n\n**각 샤드는 Lucene 인덱스와 1:1 대응**됩니다.\n즉, Elasticsearch 인덱스 내의 각 샤드는 실제 검색과 인덱싱 작업을 수행하는 하나의 Lucene 인덱스입니다.\nElasticsearch는 이러한 Lucene 인덱스들을 여러 노드에 걸쳐 관리함으로써 높은 가용성과 확장성을 제공합니다.\n\n#### Lucene 인덱스의 구조\n\nLucene 인덱스는 여러 개의 **세그먼트**라는 작은 단위로 이루어져 있고, 세그먼트는 검색 엔진의 기본 단위입니다.\n\n여기서 \"세그먼트\"란 문서 데이터를 인덱싱한 후 저장하는 **불변(immutable)한 컨테이너**를 말합니다. \n한 번 생성된 세그먼트는 변경되지 않습니다.\n\n예를 들어 영화 정보가 새로 추가되면 Elasticsearch는 즉시 기존 인덱스를 수정하지 않고,\n먼저 문서를 **메모리 버퍼에 임시로 저장한 후 일정량이 모이면 하나의 세그먼트**로 만들어 디스크에 기록합니다.\n\n만약 데이터가 많이 쌓이면 **여러 세그먼트를 하나로 합치는 병합(merge) 작업**을 수행하여,\n이 과정에서 삭제된 문서나 업데이트로 인해 soft-delete 되어있던 불필요한 데이터를 정리합니다.\n\n영화 정보를 **수정**할 때도 기존 세그먼트를 직접 수정하지 않고, 해당 문서를 soft-delete 처리한 후 새 문서를 삽입합니다.\n\n이처럼 수정할 때 바로 덮어쓰지 않는 이유는 **데이터가 한 번 정리되어 저장되면 다시 바꾸지 않는 불변(immutable)한 성질** 때문인데, 이 구조는 여러 장점이 있습니다.\n\n1. **쓰기 성능 향상**: 새로운 문서를 추가할 때 기존 세그먼트 수정 없이 빠르게 추가할 수 있습니다.\n2. **효율적인 캐싱 가능**: 세그먼트는 변경되지 않으므로 메모리나 SSD에 안전하게 캐시할 수 있습니다.\n3. **간소화된 동시성 처리**: 읽기 작업 시 데이터가 중간에 변경되지 않기 때문에 여러 사용자가 동시에 접근해도 문제가 발생하지 않습니다.\n4. **쉬운 복구**: 시스템 장애가 발생해도 세그먼트 상태가 일정하므로 복구에 용이합니다.\n5. **최적화된 압축**: 불변 데이터는 더 효과적으로 압축할 수 있습니다.\n    \n    데이터가 변하지 않으므로 압축 알고리즘은 반복되는 패턴이나 중복된 정보를 더 빨리 찾아내고 이를 반영할 수 있습니다.\n    그리고 데이터가 변경되지 않으므로 한 번 압축 작업을 최적화해 두면 이후 다시 재계산할 필요가 없습니다.\n    \n6. **빠른 검색**: 검색을 위한 자료구조와 알고리즘을 최적화할 수 있습니다.\n\n하지만 불변 구조는 **주기적으로 세그먼트를 병합**해야하고, 병합이 진행되기 전까지는 **임시 저장 공간이 증가**한다는 단점도 있습니다.\n\n#### Lucene 세그먼트의 주요 기능\n\nLucene 세그먼트는 단순히 문서를 저장하는 컨테이너 이상의 역할을 하는데, 세그먼트 내부에는 검색에 최적화된 다양한 자료구조가 들어있습니다.\n\n그 중 가장 중요한 두 가지는 다음과 같습니다.\n\n1. **Inverted Index**\n\n    Inverted Index는 모든 문서에서 등장하는 **고유한 단어**들을 **Key**로 하여 각 단어가 등장하는 **문서들의 ID 목록을 저장**합니다.\n        \n    예를 들어, 10억 편의 영화 중에서 \"인셉션\"이라는 단어가 들어간 영화만 찾고 싶을 때, 모든 영화를 처음부터 끝까지 뒤지는 대신 \"인셉션\"에 해당하는 문서 ID 목록만 빠르게 조회할 수 있습니다.\n    이렇게 하면 검색 시간이 O(n)에서 O(1) 정도로 크게 단축됩니다.   \n    \n2. **Doc Values**\n\n    만약 검색 결과를 가격이나 평점처럼 특정 필드를 중심으로 **정렬**해야 한다면 Doc Values라는 자료구조가 사용됩니다.\n    \n    Doc Values는 모든 문서의 해당 필드 값을 **column 단위로 연속적으로 저장**하고, 전체 문서를 읽지 않고도 필요한 데이터만 빠르게 읽어올 수 있게 도와줍니다.\n    (Spark나 Redshift같은 대규모 데이터 분석 도구들도 유사한 방식으로 데이터를 저장합니다.)\n\n#### 코디네이팅 노드\n**코디네이팅 노드**는 검색 요청을 받고 이를 처리할 때 **\"어떤 방식으로 검색하는 것이 가장 빠를까?\"** 라는 결정을 내리기도 합니다.\n\n여기서 가장 중요한 단계는 **Query planning** 입니다.\n\n쿼리 플래너는 검색 쿼리를 분석하여 어떤 방식으로 검색하는 것이 가장 효율적인지 결정합니다.\n예를 들어, \"크리스토퍼 놀란\" 감독의 영화를 검색할 때, 놀란 감독의 **이름이 영화 데이터 전체에 얼마나 자주 등장**하는지, **영화 제목이나 설명의 길이**는 어떤지 등의 정보를 분석해서 효율적인 검색 순서를 결정합니다.\n\n즉, 쿼리 플래너는 각 필드의 통계, 인기 키워드, 문서 길이 등 여러가지 요소를 고려하여 검색 순서를 선택하고, 여러 노드의 결과를 어떻게 합칠지 결정합니다.\n\n## 고려 사항\n1. Elasticsearch는 **검색 전용 엔진**이므로 데이터의 영구 저장은 다른 데이터베이스에 하고, elasticsearch는 그 데이터에 대한 검색을 제공하는 용도로 사용하는 것이 좋습니다.\n2. Elasticsearch는 읽기/검색 작업에 최적화되어 있으므로, 만약 **데이터가 자주 수정된다면 성능이 떨어질 수** 있습니다.\n3. 검색 결과가 **실시간으로 최신 정보를 반영하지 않을 수** 있습니다. (**eventual consistency**) 그래서 실시간성이 중요한 경우에는 다른 대안을 고려해야 합니다.\n4. 데이터를 효율적으로 검색하기 위해서는 **데이터 구조를 미리 잘 설계(비정규화)** 해야 합니다.\n5. Elasticsearch와 주 **데이터 저장소간의 데이터 동기화 문제**에 주의해야 합니다.\n\n## 특징\n1. 데이터가 **한 번 저장되면 바뀌지 않는 불변성**을 이용하면 데이터의 캐싱, 압축, 동시 접근 등이 훨씬 용이해집니다.\n2. **검색 요청을 처리하는 과정과 데이터를 저장하는 과정을 분리**하여 각각 독립적으로 최적화할 수 있습니다.\n    \n    예를 들어 데이터의 양이 너무 많아 저장과 인덱싱 처리 능력이 중요하다면 데이터 노드를 추가하여 저장 공간과 인덱싱 성능을 확장시킬 수 있고,\n    사용자가 검색 요청을 많이 보내는 경우에는 코디네이팅 노드를 추가하여 쿼리 처리 능력을 강화할 수도 있습니다.\n    \n3. 특정 **검색 패턴에 맞춰 데이터를 저장하는 인덱싱 전략**은 검색 성능에 큰 영향을 미칩니다.\n4. 여러 대의 노드가 함께 작업하는 분산 시스템은 확장성과 fault tolerance를 제공하지만, 데이터 일관성이나 네트워크 문제 등 복잡한 문제들도 함께 발생하므로 **CAP Theorem 사이의 균형**을 잘 맞춰야합니다.\n5. 특정 용도에 맞춰 **최적화된 자료구조를 선택**하는 것이 성능 향상에 매우 중요합니다.\n\n## References\nhttps://www.paradedb.com/blog/elasticsearch_vs_postgres\n\nhttps://medium.com/swlh/bkd-trees-used-in-elasticsearch-40e8afd2a1a4\n\nhttps://j.blaszyk.me/tech-blog/exploring-apache-lucene-index/\n"])</script><script>self.__next_f.push([1,"b:[\"slug\",\"system-design/elasticsearch\",\"c\"]\n13:[]\n"])</script><script>self.__next_f.push([1,"0:[\"$\",\"$L4\",null,{\"buildId\":\"yWo6j6UT3T854nh_F46fM\",\"assetPrefix\":\"/julie\",\"urlParts\":[\"\",\"blog\",\"system-design\",\"elasticsearch\",\"\"],\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"system-design/elasticsearch\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"system-design\\\",\\\"elasticsearch\\\"]}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"system-design/elasticsearch\",\"c\"],{\"children\":[\"__PAGE__\",{},[[\"$L5\",[\"$\",\"$6\",null,{\"fallback\":null,\"children\":[\"$\",\"$L7\",null,{\"reason\":\"next/dynamic\",\"children\":[\"$\",\"$L8\",null,{\"post\":{\"slug\":\"system-design/elasticsearch\",\"categorySlug\":\"system-design\",\"title\":{\"ko\":\"엘라스틱서치\",\"en\":\"Elasticsearch\"},\"date\":\"2025-02-24 14:16\",\"category\":{\"ko\":\"시스템 디자인\",\"en\":\"System Design\"},\"description\":{\"ko\":\"엘라스틱서치의 기본 개념과 동작 원리\",\"en\":\"Intro to Elasticsearch and how it works\"},\"content\":\"$9\"}}]}]}],null],null],null]},[null,[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$b\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[[null,[\"$\",\"$Ld\",null,{\"children\":[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}],\"params\":{}}]],null],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/julie/_next/static/css/064e10fa6619f508.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/julie/_next/static/css/e680cef9016abb97.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"ko\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"__className_29e2ff\",\"children\":[\"$\",\"$Le\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[\"$\",\"$Lf\",null,{\"children\":[[\"$\",\"$L10\",null,{}],[\"$\",\"$La\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$Lc\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[]}]]}]}]}]}]],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$L11\"],\"globalErrorComponent\":\"$12\",\"missingSlots\":\"$W13\"}]\n"])</script><script>self.__next_f.push([1,"11:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Julie Lee's Portfolio\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"Welcome to Julie's portfolio page.\"}],[\"$\",\"meta\",\"4\",{\"name\":\"next-size-adjust\"}]]\n5:null\n"])</script></body></html>